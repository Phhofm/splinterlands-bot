const fetch = require("node-fetch");
const fs = require('fs');


const distinct = (value, index, self) => {
    return self.indexOf(value) === index;
}

async function getBattleHistory(player = '', data = {}) {
    const battleHistory = await fetch('https://api.steemmonsters.io/battle/history?player=' + player)
        .then((response) => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response;
        })
        .then((battleHistory) => {
            return battleHistory.json();
        })
        .catch((error) => {
            console.error('There has been a problem with your fetch operation:', error);
        });
    return battleHistory.battles;
}

const extractGeneralInfo = (x) => {
    return {
        created_date: x.created_date ? x.created_date : '',
        match_type: x.match_type ? x.match_type : '',
        mana_cap: x.mana_cap ? x.mana_cap : '',
        ruleset: x.ruleset ? x.ruleset : '',
        inactive: x.inactive ? x.inactive : ''
    }
}

const extractMonster = (team) => {
    const monster1 = team.monsters[0];
    const monster2 = team.monsters[1];
    const monster3 = team.monsters[2];
    const monster4 = team.monsters[3];
    const monster5 = team.monsters[4];
    const monster6 = team.monsters[5];

    return {
        summoner_id: team.summoner.card_detail_id,
        summoner_level: team.summoner.level,
        monster_1_id: monster1 ? monster1.card_detail_id : '',
        monster_1_level: monster1 ? monster1.level : '',
        monster_1_abilities: monster1 ? monster1.abilities : '',
        monster_2_id: monster2 ? monster2.card_detail_id : '',
        monster_2_level: monster2 ? monster2.level : '',
        monster_2_abilities: monster2 ? monster2.abilities : '',
        monster_3_id: monster3 ? monster3.card_detail_id : '',
        monster_3_level: monster3 ? monster3.level : '',
        monster_3_abilities: monster3 ? monster3.abilities : '',
        monster_4_id: monster4 ? monster4.card_detail_id : '',
        monster_4_level: monster4 ? monster4.level : '',
        monster_4_abilities: monster4 ? monster4.abilities : '',
        monster_5_id: monster5 ? monster5.card_detail_id : '',
        monster_5_level: monster5 ? monster5.level : '',
        monster_5_abilities: monster5 ? monster5.abilities : '',
        monster_6_id: monster6 ? monster6.card_detail_id : '',
        monster_6_level: monster6 ? monster6.level : '',
        monster_6_abilities: monster6 ? monster6.abilities : ''
    }
}

let users = [];
let battlesList = [];
//usersToGrab = ["rus48-bot", "jengley", "pippocollasso", "blumela", "azwa", "chocolegend04", "chambelier", "jepex", "phoenixfest", "urchintrader", "quirp", "remmyrae", "alricstormbringr", "rus32-bot", "lafona", "toycard", "cryptotaz", "brilliant-banjo", "rus23-bot", "takeru255", "funky-farm", "pk-for-people", "cultured-creek", "funnel", "rus19-bot", "naturelife", "limonad", "buff-buff", "kamuu", "chococandi", "ambulorbis", "jegewav", "luyz", "aaronli", "rus31-bot", "zgil", "enthef", "clm", "oksanastar", "rahulsingh25843", "boss90", "koolinate", "sm-navidad", "aano", "daymardance", "marcelo182", "likar", "makspowerbro17", "dexent", "kefer", "birthritual", "silverbug", "inversionista", "wayoutwest", "rus01-bot", "samruk", "crystalpacheco30", "yehak", "themanwecanblame", "betojose30", "stolik", "jatut", "enminers-19", "restinpeace", "a1492dc", "b0ga4", "joseph230", "smonbear", "sosop", "rus06-bot", "coffeeheater", "nobitaa", "xta", "xosem", "helcuras", "thesplinterland", "baduka", "exiledlegion", "dharanir", "hardingicefield", "realrj", "olvaus", "barsyk", "gigel6", "mister.arianthus", "elfy411", "mumma-monza", "mistakili", "hotterthanhell", "azaad", "bobokyaw", "xzg", "buldozor", "megaeoz", "shitsignals", "flamo", "tinamarr", "hirume", "smast", "nuclearmonk", "shaheerbari", "elpenyar", "louisianimal", "oksanauk", "theheat", "nepomuseno", "igor11123", "reoparker", "casimira", "elneno", "pialejoana", "olopezdeveloper2", "dazzling-dentist", "monster.free", "paypalhouse", "renypk", "flyerchen", "qqueenqueen", "splinterembassy", "cyberblock", "outlinez", "conme", "rizqyeka", "leebo86", "register50", "maddietel", "pataty69", "zenere", "musicgeek", "cryptonnja", "hevpleon", "dboontje", "brucutu2", "sumatranate", "mamaculo", "difools", "borodas", "paraguana", "tayler", "schubes", "sawcraz.art", "stephalt", "pi1", "go-kyo", "thallid", "kaeves4711", "votingpower", "crisangel", "gaeljosser", "thepalaceguard", "monstersforfree", "phat64", "madgold", "ceewye", "duppo", "juanos", "gast0n", "syedshakil", "bolachasmonster", "swordsoffreedom", "brandaswitch", "smonian", "lupee", "ajjec", "sgsgsg", "lets-rumble", "gleaming-glacier", "sparkofphoenix", "p-a", "olaexcel", "bepokic", "toto10", "carioca", "kitty-kitty", "ukprepper", "laughalittle2day", "markus.journey", "julian10", "zekans84", "jiuinfo", "sher10ck", "veteran-rus", "makogr4", "powermaster", "greddyforce", "elvinho", "minibaryl", "splinterlands-ru", "jussara", "dexy50", "lostkluster", "menclub", "andruto", "cerf", "feminineenergy", "yabapmatt", "theteoz", "wisejg", "jleonardorf", "tzukhan", "muchsteemsowow", "asadnaymur", "senat0r", "agoodaccount", "vjap55", "liuke99player", "amamless", "stefano.massari", "rus24-bot", "enminers-8", "gerisn", "rus18-bot", "mismon", "alliedforce", "be-inspired", "kumquat-cake", "vaca3", "tiburones", "mer1in", "rus14-bot", "clackity", "gigel1", "chocoshogun", "meins0815", "smhive", "conthong", "monsterpiadas", "rakison2", "gonk-droid", "fiat600", "faizan-ashraf", "blueskymin", "icegianter", "alureoftheearth", "krikblock", "velourex.play2", "city-of-berlin", "rus22-bot", "tanimus", "freedomteam2019", "rus35-bot", "karinapac", "sonki999", "bang0", "diebaasman", "yeman", "fotik", "rus09-bot", "cunigarro", "rus50-bot", "an-1", "enminers-21", "braz", "th12-egoista", "gioele13", "accountsdump", "stephavellaneda", "ishare", "kixon1993", "proto26", "vonefas", "dracosilver", "superbad", "pelayo", "vasigo", "daraly", "level1sm", "maheshbhai", "jferdous", "chocolegend01", "ducthanh", "rus41-bot", "nessos", "dismayedworld", "manmen", "zavala", "bulletmind", "jurajimmy", "sm-school", "alobiun", "drsun", "shepz1", "aaronli", "gigel4", "papeda-pizza", "ninjamike", "dwinf", "shvara", "jiheref", "boobie-trap", "dinklebot", "mcoinz79", "xplosive", "azw", "chocoluche", "rodchenko", "doom2", "ran.koree", "paredao", "quatre-raberba", "dredgenyor", "lime-soup", "jamzmie", "ksantoprotein", "mikan-milkshake", "pesterson", "thomasward9", "butanopropan", "jomeb", "untamedspirit", "transom", "khaled1997", "squatme", "labold", "feduk", "rus46-bot", "po2", "oryans.belt", "yitige", "seblak", "bimol", "idkpdx", "logika", "mctoph", "whizzkid", "clausewitz", "enminers-13", "cesarmorles", "zu-jyuva", "cryptosales", "rus29-bot", "hafizz", "megateo", "urgrant", "febil", "torachibi", "if-time", "cryplectibles", "francis228", "hanen", "thegamechain", "erikkartmen", "tezcatli", "danny23", "dflz17", "siong", "cryptissues", "chrstnv", "creationlogic", "bengiles", "belaz", "tepobib", "figaro001", "retirebygaming", "smoner", "itisfinished", "malric-inferno", "silverwinner", "howerot", "waterchasers", "rikyu", "tomy5", "ana-maria", "beco132", "orangelo-oatmeal", "soang", "bereg", "elukas", "atnep111", "civilengineer13", "wisdome", "rus15-bot", "tronhill", "tr77", "tyreen", "mi2", "khazbot", "scar1ett", "monsterfightclub", "divachev", "rearguard", "karlosjmp", "athira", "lucassgrfy", "andrenavarro", "coolepicguy123", "caritoos", "bobor", "lzh1703", "pauleniuks", "splinterland", "inventive-isle", "seens", "electru", "agridulce2", "cryp71x", "armenian-gull", "ronyparra", "chocolinda", "asadnaymur", "galdirea", "rus03-bot", "orange-pie", "anneadam", "derion", "w121212", "brumgunter", "habibabiba", "stolik", "hitono", "tyara", "stranniksenya", "clap-trap", "proteus", "therentaltest", "hausner", "mawichan04", "bronkong", "sebaf", "guerrillakills", "pokat", "burdjg", "krabik", "naythan", "iceweex", "chicoduro", "alex-alexander", "antithb", "winmaster1", "banktest", "verlaat", "chargeblock", "s77assistant", "greens-creek", "eyewitness", "xandr", "reversemagnetar", "lolq", "amelino", "nirat", "sxsy", "tibl", "parnter", "andrea01", "stairway2heaven", "rus49-bot", "emilius", "loperdt", "biplan", "lice", "softa", "genesis05", "trezeke", "sc-steemit", "bbdragon", "mad-moxxi", "makspowerbro7", "thevilspawn", "swarmee", "thevil", "chipman", "zhivchak003", "sanze", "brunay", "toffie", "rus38-bot", "pomelo-pancake", "greatbulloffire", "ryanrother", "koosventerza", "nelpa411", "boroznak", "limurg", "vvonderlander", "esteh", "lalong", "jwjqu.wam", "ywe", "chromiumone", "bakpao", "didara", "periods", "rus37-bot", "zoje", "alangrizz", "torbaap", "damaskinus", "pionerbank", "gamegiveaways", "sm-rules", "dmitriyyandreev", "enminers-6", "kelse", "rus33-bot", "azt", "thedragonwarrior", "adversus", "soulseeker-bcn", "cal2", "tortila", "splinterquest", "didara", "lolq", "realrj", "azt", "thedragonwarrior", "adversus", "soulseeker-bcn", "lapierre", "cal2", "galdirea", "hirume", "khalifaimaman", "stevescoins", "sm-skynet", "flyingkrak", "raste", "yousafharoonkhan", "adelinak", "soldieroffire", "normanrainbows", "gpiglioni", "rus30-bot", "szymonkus", "ywe", "clicktokill", "nivanger", "alextribeck100", "sketcher", "invest2learn", "bala-sm", "sagesigma", "therentaltest", "tagal", "makspowerbro10", "devo4ka", "rosew", "enminers-6", "kolxoz", "mortysanchez", "xum", "marinmex", "rus27-bot", "sxsy", "kristhall", "wasseir", "citron-cider", "momih", "xta", "rus11-bot", "tamer34", "minismallholding", "meheraj", "gigel4", "dilar", "makspowerbro5", "ig-100", "posty", "supercuota", "bzybyte", "erwinj888", "buckfourton", "amanfoi", "maloveg", "cadbane", "reavercois", "azq", "siviv", "rus13-bot", "madasaboxof", "valapop", "wxw", "cassidyandfranks", "cal3", "yeaho", "bazilik", "cryptocrusaders", "fenyrahma", "alexgamer", "ivansnz", "pomelo-pancake", "kamillaevd", "eirik", "oscaryayoy8", "imila", "sensful", "jznsamuel", "falen", "traveljack894", "nyswine", "wamele", "duun", "anttila", "rus43-bot", "aicu", "dobroman", "monstress", "notzna", "cryptomb", "makspowerbro13", "calwa", "jodzuone",'tungnguyenf8',' DMALINA',' bronzechicken2',' tiendung004',' tiendzung015',' velandan',' hyiponlinef',' tiendzung012',' rkps',' dgu-dgul',' quycmf8',' romapopov1190',' parladar',' watchpaper8320',' unan1',' lyannainferno2',' hamsterperson',' nicole-st',' nongru6',' proizvedenie',' korshack',' laskal',' cloudskyuiu',' ABUZER357',' myso',' cryptomonkeys-cc',' miningbees03',' peterlane',' malchick',' pauljencio',' ngoclinhmuoif6',' tiendzung019',' uyenniel',' blago1',' NELOANGELO',' august6314',' fedil',' locnguyenciu',' eclipsus',' thaihang12',' bola8',' camerayoosee202',' larinett',' titannichyip',' luubadaif7',' buteco',' tiendzung010',' fakemilka3',' DiegoTrinh',' lamtuanvu',' benderreborn',' ngoclinhf90',' okthen',' chryonex31',' linhnv010',' y327322408',' cameraxmeye104',' zazza77',' y325824613',' kaineki',' kimidoram8',' hidrante',' angelino114',' linhnv011',' trinhnguyenf98',' angela77',' dangthai123',' camerayoosee204',' nongru5',' fakemilka4',' buysomething1',' tiendzung014',' bynarang',' y376294831',' felix199810',' homa322',' hckfy197',' erwin.alcober',' ngochienmuoif1',' cryptomusk',' chanchanfi',' hantinf66',' yeuemffu',' banza',' monsterheaven',' lucidialcake',' monterarni',' irina456vl',' preta',' quantumexplorers',' mindingo',' MEDALOGON',' restongungui',' plavki',' cameraxmeye105',' jerry.van.lee',' karavan110803',' gribok',' jgkforork',' tiendzung011',' sixsamurai-fuuma']
// on splinterlands click on leaderboard, then copy the json from the networks tab (the leaderboard part) then go to jsoneditoronline.org paste it there, then click filter, then use a query like leaderboard[*].player click on code and copy the list
usersToGrab = [
    "helaman", // me
    "superbly", // the bronze leaderboard top 100 on 6.sept.21
    "kingfoodie",
    "mrpopcycle",
    "yeshuathehighest",
    "bentoytzy",
    "anthony555",
    "splinterlands-ru",
    "maynard69",
    "shin92",
    "sunsetfox",
    "mongysalmon",
    "kimmitan0505",
    "iyaiyayo",
    "llamakron",
    "porquito",
    "jsangeles1",
    "slyang",
    "malditaz2415",
    "blackzoda",
    "penguin11",
    "jcpg",
    "schwarszchild",
    "enervaughn",
    "djspy",
    "rundee",
    "drizzle-x",
    "juggernaut27",
    "pakaradol",
    "petchvrp",
    "fooking",
    "malditaz24",
    "player175",
    "flavoursymmetry",
    "xiaodee",
    "kromosoms",
    "zanjikizan",
    "boss-poy",
    "newtonatta",
    "attic100",
    "zrosh",
    "kyleeee",
    "optimalprime",
    "mike1986",
    "hiirotoo",
    "luchoboy",
    "funkyfish",
    "absea",
    "tahafe",
    "macktails",
    "xyka2",
    "jopelicious",
    "saharamee",
    "malacaboi",
    "lord-bones",
    "fleiro",
    "jhix",
    "budoyy414",
    "menix",
    "gadesa",
    "foodyhanoi",
    "xiaovoice",
    "aubryd",
    "vuvuive04",
    "urleh02",
    "foodieking",
    "hiiro",
    "keulzyx",
    "ogrosgo",
    "jeyaram15",
    "lagiwed",
    "gieosanorjo",
    "rayver0329",
    "been2546",
    "england03",
    "jnario",
    "eco-worrier",
    "kuysneil",
    "cryptc27",
    "nonkew",
    "klarksanity",
    "qastador",
    "c0nst",
    "sfarinari",
    "sahabigup",
    "hiv3",
    "drenzy",
    "ashen.zero",
    "herox",
    "vanillacinammon",
    "kimi-no-yawa",
    "evilcrow69",
    "kojoko",
    "sire1223",
    "whatever-tv",
    "paulnath0017",
    "junoxd",
    "jbs07",
    "annj",
    "hiryur",
    "paytowin",
    "kira1995", // silver top 100
    "baupade",
    "johnmelissaski",
    "yozen",
    "nexneveau",
    "smukkers",
    "killerkev",
    "vxc",
    "backflip55",
    "sevenoh-fiveoh",
    "johnhtims.life",
    "senojuro",
    "dragon.rider",
    "arteous",
    "bebeomega",
    "vinhald",
    "g-beard",
    "chippymonkey",
    "wehaveall",
    "ez27000",
    "mious",
    "jjglanton",
    "thanksforplaying",
    "seesensei",
    "salvao",
    "dcx02",
    "chasingpennies",
    "walner",
    "cryptospectre",
    "homesteadhacker",
    "marabara",
    "finarfin",
    "tim.hendrix",
    "dead-pan-dan",
    "haedan",
    "ibu1987",
    "athunderstruck",
    "mugiwaratny08",
    "undefineted",
    "buggedout",
    "zaidaguevarae",
    "whatmonday",
    "frugal-fun",
    "leopardvu",
    "sorrynotsorry",
    "clickfornick",
    "jos3lider",
    "rektanon",
    "boonierator",
    "krma",
    "adamaro",
    "guest1",
    "xeraphim",
    "grimmazrael",
    "buddy06",
    "xhardbeast",
    "jaybone",
    "trokari",
    "jasontiller",
    "neladepablos",
    "posei",
    "faithinamerica",
    "valchiz",
    "atnep111",
    "breadsticks",
    "kalmere",
    "hawks21",
    "tst-cautionfun",
    "speedsterino",
    "shunizaki",
    "rokugou",
    "angrychipmunk1",
    "misterpanda",
    "jabzcrypto91",
    "noticias-garmor",
    "finwe",
    "moove00",
    "talokabobomo",
    "zeck",
    "biffdk",
    "criptosectadepit",
    "beachtime",
    "ajaxwest",
    "emzor",
    "sai-ngeal",
    "mister.arianthus",
    "steallion",
    "dragondestroyer",
    "chrisamuda",
    "dani7773",
    "amaari",
    "swampthing",
    "tamaoserizawa",
    "cardauctionz-3",
    "captaincrown",
    "yongpaypal",
    "asuranplus",
    "barba12",
    "nightflows",
    "jepepe",
    "byzantinist", // gold top 100
    "ula.ocean",
    "megalithic",
    "byzantinekitty",
    "teejays",
    "thorkon",
    "masshole",
    "trudders",
    "tj70903",
    "arvin84",
    "kleif",
    "monsterdoom",
    "rudora",
    "jose27117",
    "markjason",
    "unitqm",
    "manfredunio",
    "bitpizza",
    "mac-spacer",
    "ashman-aces",
    "thekillingqueen",
    "zawarrior",
    "noisme",
    "diswark",
    "haflblue",
    "poytipoy",
    "freedomfighter4",
    "drmlight",
    "hansgans",
    "hanthejackal",
    "gustavhaas",
    "moon32walker",
    "olopezdeveloper",
    "bp9930",
    "gooddeck",
    "jeffopenscards",
    "drmugg",
    "kn0xville",
    "prec",
    "jrpserra4",
    "ogelthegreat",
    "govankilgour",
    "donekim",
    "dteles",
    "crypstocks",
    "rwen15",
    "monsterstamer",
    "schach",
    "mctopherson",
    "wolvowen",
    "dreadlord",
    "jrpserra5",
    "lingus",
    "kalyus",
    "shinrai",
    "deoxy2",
    "peakfighter",
    "demonic23",
    "hakaishin23",
    "mavrik",
    "kratos01",
    "diswar",
    "marioma",
    "calebj",
    "leizerstark",
    "wackojacko21",
    "pallas-gull",
    "blueeyes8960",
    "hiddentest",
    "erendabi",
    "bentley33",
    "jrpserra",
    "boichun",
    "the10legmulti",
    "eddsy",
    "igopdadomlet",
    "ohliang",
    "legionella",
    "doffyzilla",
    "eldaniel",
    "emperorlight4",
    "costanza",
    "robinsonr810",
    "sjeymastwr",
    "randope",
    "themagicking",
    "definitelyn0tme",
    "beik47",
    "prince.akashi",
    "hakutsake-5",
    "kittenz",
    "kalam",
    "cryptofiloz",
    "uchihabr",
    "dadicus",
    "houdini80",
    "romanforever",
    "philippekiene",
    "megahenhen",
    "tangywalrus",
    "wer-gewinnt", //diamond top 100
    "yabalka",
    "gienpeart",
    "infinityx22",
    "louis88",
    "stiant",
    "newageinv",
    "teddykgb",
    "oriridragon",
    "tehox",
    "davel22",
    "hametaro",
    "goldy146",
    "fantasycrypto",
    "carpentr",
    "beeyou",
    "nrg",
    "moriarty95",
    "jaki01",
    "vcdragon",
    "steem.drone",
    "kitkatkatie",
    "rreddevil",
    "bandogge",
    "ty2nicerva",
    "raised2b",
    "rooo",
    "cryptoeater",
    "akiramagna",
    "hashmask",
    "danfro",
    "giker",
    "bathoi",
    "tidepodoreos",
    "photohunt",
    "ram.here",
    "kykai",
    "zagorlord",
    "goodhello",
    "matt-dub",
    "red-dog",
    "monstermother",
    "ts-neoxian",
    "cjturtleman",
    "kher99",
    "saffisara",
    "wonsama",
    "nateaguila",
    "schachoberhessen",
    "vettev",
    "matsoni",
    "mzkntk",
    "dreamer201",
    "themightyvolcano",
    "bennettitalia",
    "g1k3r",
    "imperij4427",
    "nepsis",
    "azircon",
    "bugsbunny-ph",
    "pancholfugazi",
    "someonesomeone",
    "goodasgold",
    "hosherama",
    "joshuasaur",
    "thebadwitch",
    "yuraso",
    "lonely1near",
    "mad-runner",
    "synrg",
    "hakutsake",
    "stokjockey",
    "pacolimited",
    "elzaaa",
    "madharps",
    "clashwitherds",
    "mantiki",
    "deriel",
    "ogierick",
    "jacy02",
    "light.starter",
    "zanmato",
    "kolokee",
    "markmaph",
    "jagaaaaaan",
    "gamerzaza",
    "switcheroo3",
    "fw206",
    "kher09",
    "xserpentine",
    "crinkles",
    "arodalzo",
    "bitcoinsig",
    "ianderik",
    "hanridoryuki",
    "xjohann",
    "germansailor",
    "firstthingsfirst",
    "saveas",
    "profkaos",
    "grand.high.witch", // champion top 100
    "shinychamp",
    "awokado",
    "bji1203",
    "jacekw",
    "bubke",
    "ts-warrior",
    "akomoajong",
    "dosh",
    "xawi",
    "shoemanchu",
    "cryptoreaper",
    "junokeo",
    "adelka",
    "raynie",
    "frosta",
    "splintercat",
    "mellofello",
    "purplegoblin",
    "palikari123",
    "rawutah",
    "clove71",
    "marianaemilia",
    "adonisabril",
    "taug",
    "chavrouse",
    "tameshon",
    "endgegner",
    "michealb",
    "whitebears",
    "twinner",
    "nardian",
    "mr-waffles",
    "maybenexttime",
    "cyguy",
    "warrentrx",
    "udow",
    "tailcock",
    "godislove777",
    "joshman",
    "nitekichi",
    "masterthematrix",
    "tendershepard",
    "firemonster",
    "hossainbd",
    "planosdeunacasa",
    "z4orce",
    "latheron",
    "monster-grinder",
    "xregios",
    "ninjascott",
    "rektall",
    "axtar",
    "gfriend96",
    "jasper23",
    "schneegecko",
    "sci-populi",
    "jrvacation",
    "khazrakh",
    "hollowknightgod",
    "gank",
    "notaboutme",
    "wuba",
    "spirits4you",
    "jesterago",
    "jigstrike",
    "uwelang",
    "ayobrando1",
    "mokoshall231",
    "ohmmygod",
    "foodieking", //last season top 100 bronze
    "fooking",
    "shin92",
    "splinterlands-ru",
    "lechatsplinter",
    "juggernaut27",
    "yeshuathehighest",
    "max-suprim",
    "mongysalmon",
    "aubryd",
    "spl.ninja",
    "ogrosgo",
    "rjanis",
    "newtonatta",
    "kimmitan0505",
    "vadan",
    "junoxd",
    "obiun",
    "pythes",
    "girge1",
    "araax",
    "beheadedallenemy",
    "klarky",
    "menix",
    "bluhat",
    "vegoz99",
    "optimalprime",
    "ultra-magnus",
    "gumi061520",
    "lordfatcat",
    "bumblebeee",
    "black-sheep",
    "kamikaruro",
    "incognit0",
    "juvan06",
    "scopespy",
    "england02",
    "mega-tron",
    "noobz",
    "wekwekwek",
    "enigmacode",
    "silentd20",
    "thetyper",
    "strawhatt",
    "kuuini",
    "hotchili",
    "ibelieveyou",
    "eco-worrier",
    "mavie09",
    "dragonseed",
    "inumaro",
    "star-scream",
    "bulkhead",
    "steel-jaw",
    "alpha30",
    "kyleeee",
    "paul2earn",
    "luv9hl",
    "ceus",
    "buttercupnoodles",
    "zeta-prime",
    "bruticus",
    "khan-sky8",
    "strong-arm",
    "polskii",
    "riverwind",
    "ajosetk",
    "wuja93",
    "gembanawa",
    "catarina-devon",
    "grim-lock",
    "poksaka",
    "sephana",
    "georgopol",
    "gogopowerrangers",
    "syogaku-toushi",
    "kektraider",
    "jaqz",
    "kaithhunter",
    "side-swipe",
    "fenngen",
    "ahfu20",
    "prope",
    "noovesonle",
    "chupainmoko",
    "viencu",
    "jerematik",
    "demonmosquitoz",
    "splayer",
    "nioky",
    "zideyn",
    "spicypotato",
    "shinatsume",
    "swodieboi",
    "sky-lynx",
    "sweetpotato23",
    "justlucky75",
    "wind-blade",
    "jinbaba",
    "adramm",
    "smukkers", //ls silver
    "johnmelissaski",
    "backflip55",
    "dragon.rider",
    "blackzoda",
    "j-p-bs",
    "nexneveau",
    "sevenoh-fiveoh",
    "baupade",
    "ibu1987",
    "kira1995",
    "vinhald",
    "normies",
    "chippymonkey",
    "zanjikizan",
    "bebeomega",
    "zaidaguevarae",
    "mugiwaratny08",
    "ueyuey",
    "adamaro",
    "guest1",
    "johnhtims",
    "elclements",
    "marabara",
    "dcx02",
    "salvao",
    "kyoshi22",
    "kate-todd",
    "misterpanda",
    "japjapgwapa",
    "hanniballector",
    "rajpet",
    "corise",
    "seesensei",
    "xeraphim",
    "labeouf",
    "rubillo15",
    "jepjeperii",
    "m4rv",
    "neladepablos",
    "xak",
    "dani7773",
    "jjglanton",
    "splintership2",
    "clairo",
    "babalor",
    "rektanon",
    "lord-bones",
    "chanc3",
    "chrisamuda",
    "arjeyo",
    "rick-wamit",
    "bangus",
    "peetathon",
    "jayz07",
    "elcristiano",
    "gunton",
    "yovanachef",
    "narya",
    "foodiekingfarm",
    "tellah",
    "michael2894",
    "erikkartmen",
    "manukass",
    "pupil74252",
    "holygiftofgod",
    "mackyzero",
    "wygame",
    "n1njaskillz101",
    "murama",
    "elukas",
    "veterinarian",
    "trongtuan6985",
    "minticles",
    "rosa35",
    "undefineted",
    "riotzane",
    "justgotlucky",
    "erincaroline",
    "gwig",
    "evilcrow69",
    "energycrystals",
    "aummahit",
    "teca",
    "neilgaming",
    "richmondespeja",
    "jeniasmooncat",
    "bosssteem",
    "miloshpro",
    "attic100",
    "magicyan",
    "ziggysd",
    "yijen",
    "dexy50",
    "juwel2018",
    "joanamay",
    "kendrad",
    "tms74",
    "mister-eagle",
    "lachty",
    "ula.ocean", //ls gold
    "byzantinist",
    "byzantinekitty",
    "megalithic",
    "monsterdoom",
    "teejays",
    "manfredunio",
    "mac-spacer",
    "arvin84",
    "ogelthegreat",
    "masshole",
    "tj70903",
    "freedomfighter4",
    "haru777",
    "wackojacko21",
    "olopezdeveloper",
    "leizerstark",
    "epicteam",
    "footman",
    "thekillingqueen",
    "trudders",
    "battleboy",
    "haflblue",
    "govankilgour",
    "johnhtims.life",
    "rocknrolla28",
    "kittenz",
    "arteous",
    "erwinj888",
    "ghostintheyel",
    "sirdemian",
    "dadicus",
    "gustavhaas",
    "splinterlordz",
    "yozen",
    "monsterstamer",
    "steallion",
    "rebelwar",
    "scar422",
    "xantis32",
    "akdx",
    "doublekarsten",
    "ashaduzzaman",
    "narota-quest",
    "christahir",
    "teckw",
    "morpheosx",
    "riotape",
    "kstru",
    "chris3009",
    "ohliang",
    "redrixsword",
    "velvin",
    "cryptospectre",
    "butters323",
    "bcvirus",
    "ann19",
    "uchihabr",
    "tipopipa",
    "xiaovoice",
    "bindrs",
    "fatboy888",
    "elevator09",
    "javiss",
    "on-the-block335",
    "demonsaint69",
    "shakilkhan",
    "djoker",
    "dirtbike",
    "adamdabeast",
    "starlightmelissa",
    "whiskaey",
    "rebellord",
    "naymur",
    "theepotatolord",
    "xiaomark",
    "george2894",
    "iceanddark007",
    "killerkev",
    "ayobrando1",
    "theguardianking",
    "daskia",
    "jos3lider",
    "jake7snyder",
    "nyooork",
    "aulikki",
    "assassin.starter",
    "markyzola",
    "rondonshneezy",
    "zykotik",
    "overall-servant",
    "vz2000",
    "yohala",
    "pepeguamo",
    "jaderwick",
    "bulldogsan249",
    "jejaime",
    "edward23",
    "xbee",
    "popoyoyo",
    "firstthingsfirst", //ls diamond
    "ram.here",
    "frosta",
    "louis88",
    "raised2b",
    "milomex",
    "yabalka",
    "infinityx22",
    "revolutionstcafe",
    "thorkon",
    "nem-xem",
    "kawash",
    "forever-crypto",
    "kryptodenno",
    "red-dog",
    "rreddevil",
    "rajkooooo",
    "imperij4427",
    "marjanko",
    "amoonshot",
    "vandalieu",
    "myfriend",
    "mango-juice",
    "goodhello",
    "kitkatkatie",
    "cluever",
    "fighter4-freedom",
    "kher09",
    "uwelang",
    "yeyed",
    "jeffandhisguitar",
    "frulili",
    "yuraso",
    "riotstarfruit",
    "foggybottom",
    "unique.esprit",
    "sirtorito",
    "broxi",
    "sandaleta",
    "oriridragon",
    "hansgans",
    "guyh777666",
    "crypstocks",
    "pandapuzzles",
    "idgie",
    "cryptkeeper17",
    "frost-eye",
    "bulldog1205",
    "khen006",
    "pardinus",
    "zeno23",
    "walidur",
    "zawarrior",
    "ifunnymemes",
    "themagicking",
    "bobcatg",
    "hanjackal",
    "adamsteele",
    "shurickan-b",
    "carlosfjr",
    "karma-sensei",
    "blueeyes8960",
    "zenimoon",
    "sweenyswift",
    "cretone",
    "fightorflight",
    "adal111",
    "vhiona13",
    "riooo",
    "dreamer203",
    "azumanga",
    "imperfect-one",
    "jhon7",
    "madharps",
    "strikehero",
    "ogreabroad",
    "nymaim",
    "jyy",
    "conan123",
    "cryptoche",
    "bamlolx",
    "ensiferum",
    "victor-alexander",
    "mistersunshine",
    "mathieu33",
    "slayer3382",
    "tangywalrus",
    "rutz555",
    "adam-001",
    "monsterlover",
    "nemorz",
    "naturalkiller",
    "shinobu15",
    "homeartpictures",
    "lordwinty",
    "hanridoryuki",
    "jacy02",
    "brontok",
    "criptoanarquista",
    "pakno",
    "bji1203", //ls champion
    "bubke",
    "jacekw",
    "awokado",
    "akomoajong",
    "grand.high.witch",
    "shoemanchu",
    "shinychamp",
    "mellofello",
    "beeyou",
    "ts-neoxian",
    "raynie",
    "xawi",
    "jrvacation",
    "clove71",
    "palikari123",
    "taug",
    "cryptoreaper",
    "ts-warrior",
    "adelka",
    "purplegoblin",
    "dosh",
    "junokeo",
    "cyguy",
    "schneegecko",
    "giker",
    "nitekichi",
    "maybenexttime",
    "splintercat",
    "sci-populi",
    "davel22",
    "marianaemilia",
    "twinner",
    "saffisara",
    "chavrouse",
    "endgegner",
    "hossainbd",
    "gienpeart",
    "madgol",
    "mr-waffles",
    "tendershepard",
    "jaki01",
    "tailcock",
    "gank",
    "hametaro",
    "moriarty95",
    "michealb",
    "latheron",
    "newageinv",
    "godislove777",
    "rawutah",
    "whitebears",
    "g1k3r",
    "firemonster",
    "udow",
    "nardian",
    "planosdeunacasa",
    "joshman",
    "monster-grinder",
    "stargame",
    "axtar",
    "notaboutme",
    "jigstrike",
    "cyberblock",
    "anubis85",
    "teddykgb",
    "fatjimmy",
    "spirits4you",
    "masterthematrix",
    "zugzies",
    "warrentrx",
    "fantasycrypto",
    "dimarius",
    "sidram",
    "azircon",
    "khazrakh",
    "monstermother",
    "themightyvolcano",
    "adonisabril",
    "vcdragon",
    "gfriend96",
    "tidepodoreos",
    "bafi",
    "molins",
    "cryptoeater",
    "bandogge",
    "steem.drone",
    "jasper23",
    "akiramagna",
    "rtron86",
    "raketenklaus",
    "germansailor",
    "ponte79",
    "danfro",
    "carpentr",
    "hollowknightgod",
    "lonely2near",
    "tehox",
    "sungjinwoo",
    "jesterago"
]


//usersToGrab = ["helaman", "superbly", "yeshuathehighest", "splinterlands-ru","maynard69","schwarszchild","anthony555", "mongysalmon", "penguin11", "bentoytzy", "llamakron", "porquito", "shin92", "slyang", "mrpopcycle", "kingfoodie", "blackzoda", "jcpg", "splinterhunter", "enervaughn", "pakaradol", "petchvrp", "malditaz2415", "fooking", "juggernaut27", "malditaz24", "player175", "xiaodee", "attic100", "zanjikizan", "jsangeles1", "sunsetfox", "zrosh", "kyleeee", "kromosoms", "luchoboy", "funkyfish", "absea", "kimi-no-yawa", "xyka2", "saharamee", "malacaboi", "flavoursymmetry", "optimalprime", "jopelicious", "jhix", "budoyy414", "gadesa", "foodyhanoi", "xiaovoice", "aubryd", "johnmelissaski", "nexneveau", "baupade", "yozen", "smukkers", "vxc", "killerkev", "backflip55", "sevenoh-fiveoh", "senojuro", "dragon.rider", "arteous", "bebeomega", "vinhald", "chippymonkey", "wehaveall", "mious", "jjglanton", "dcx02", "walner", "homesteadhacker", "marabara", "seesensei", "tim.hendrix", "dead-pan-dan", "haedan", "ibu1987", "g-beard", "athunderstruck", "dani7773", "buggedout", "thanksforplaying", "whatmonday", "zaidaguevarae", "cryptospectre", "krma", "jos3lider", "frugal-fun", "yongpaypal", "adamaro", "finarfin", "guest1", "salvao", "undefineted", "xeraphim", "buggedout", "leopardvu", "jasontiller", "jos3lider", "rektanon", "krma", "sorrynotsorry", "adamaro", "grimmazrael", "xhardbeast", "trokari", "jaybone", "neladepablos", "posei", "faithinamerica", "valchiz", "byzantinist", "ula.ocean", "megalithic", "byzantinekitty", "teejays", "thorkon", "masshole", "trudders", "arvin84", "kleif", "monsterdoom", "rudora", "markjason", "jose27117", "unitqm", "manfredunio", "bitpizza", "mac-spacer", "ashman-aces", "thekillingqueen", "zawarrior", "noisme", "poytipoy", "freedomfighter4", "dreadlord", "drmlight", "hanthejackal", "gustavhaas", "haflblue", "moon32walker", "gooddeck", "jeffopenscards", "drmugg", "knoxville", "jrpserra4","prec", "ogelthegreat", "dteles","crypstocks","rwen15","diswark","monsterstamer","mctopherson","donekim","lingus", "wer-gewinnt","yabalka","gienpeart","infinityx22","louis88","stiant","oriridragon","teddykgb","davel22","tehox","hametaro","goldy146","fantasycrypto","carpentr","beeyou","newageinv","jaki01","steem.drone","vcdragon","bji1203", "giker", "latheron", "jrvacation", "ts-neoxian", "cryptoreaper", "firemonster", "sungjinwoo", "rus48-bot", "jengley", "pippocollasso", "blumela", "azwa", "chocolegend04", "chambelier", "jepex", "phoenixfest", "urchintrader", "quirp", "remmyrae", "alricstormbringr", "rus32-bot", "lafona", "toycard", "cryptotaz", "brilliant-banjo", "rus23-bot", "takeru255", "funky-farm", "pk-for-people", "cultured-creek", "funnel", "rus19-bot", "naturelife", "limonad", "buff-buff", "kamuu", "chococandi", "ambulorbis", "jegewav", "luyz", "aaronli", "rus31-bot", "zgil", "enthef", "clm", "oksanastar", "rahulsingh25843", "boss90", "koolinate", "sm-navidad", "aano", "daymardance", "marcelo182", "likar", "makspowerbro17", "dexent", "kefer", "birthritual", "silverbug", "inversionista", "wayoutwest", "rus01-bot", "samruk", "crystalpacheco30", "yehak", "themanwecanblame", "betojose30", "stolik", "jatut", "enminers-19", "restinpeace", "a1492dc", "b0ga4", "joseph230", "smonbear", "sosop", "rus06-bot", "coffeeheater", "nobitaa", "xta", "xosem", "helcuras", "thesplinterland", "baduka", "exiledlegion", "dharanir", "hardingicefield", "realrj", "olvaus", "barsyk", "gigel6", "mister.arianthus", "elfy411", "mumma-monza", "mistakili", "hotterthanhell", "azaad", "bobokyaw", "xzg", "buldozor", "megaeoz", "shitsignals", "flamo", "tinamarr", "hirume", "smast", "nuclearmonk", "shaheerbari", "elpenyar", "louisianimal", "oksanauk", "theheat", "nepomuseno", "igor11123", "reoparker", "casimira", "elneno", "pialejoana", "olopezdeveloper2", "dazzling-dentist", "monster.free", "paypalhouse", "renypk", "flyerchen", "qqueenqueen", "splinterembassy", "cyberblock", "outlinez", "conme", "rizqyeka", "leebo86", "register50", "maddietel", "pataty69", "zenere", "musicgeek", "cryptonnja", "hevpleon", "dboontje", "brucutu2", "sumatranate", "mamaculo", "difools", "borodas", "paraguana", "tayler", "schubes", "sawcraz.art", "stephalt", "pi1", "go-kyo", "thallid", "kaeves4711", "votingpower", "crisangel", "gaeljosser", "thepalaceguard", "monstersforfree", "phat64", "madgold", "ceewye", "duppo", "juanos", "gast0n", "syedshakil", "bolachasmonster", "swordsoffreedom", "brandaswitch", "smonian", "lupee", "ajjec", "sgsgsg", "lets-rumble", "gleaming-glacier", "sparkofphoenix", "p-a", "olaexcel", "bepokic", "toto10", "carioca", "kitty-kitty", "ukprepper", "laughalittle2day", "markus.journey", "julian10", "zekans84", "jiuinfo", "sher10ck", "veteran-rus", "makogr4", "powermaster", "greddyforce", "elvinho", "minibaryl", "splinterlands-ru", "jussara", "dexy50", "lostkluster", "menclub", "andruto", "cerf", "feminineenergy", "yabapmatt", "theteoz", "wisejg", "jleonardorf", "tzukhan", "muchsteemsowow", "asadnaymur", "senat0r", "agoodaccount", "vjap55", "liuke99player", "amamless", "stefano.massari", "rus24-bot", "enminers-8", "gerisn", "rus18-bot", "mismon", "alliedforce", "be-inspired", "kumquat-cake", "vaca3", "tiburones", "mer1in", "rus14-bot", "clackity", "gigel1", "chocoshogun", "meins0815", "smhive", "conthong", "monsterpiadas", "rakison2", "gonk-droid", "fiat600", "faizan-ashraf", "blueskymin", "icegianter", "alureoftheearth", "krikblock", "velourex.play2", "city-of-berlin", "rus22-bot", "tanimus", "freedomteam2019", "rus35-bot", "karinapac", "sonki999", "bang0", "diebaasman", "yeman", "fotik", "rus09-bot", "cunigarro", "rus50-bot", "an-1", "enminers-21", "braz", "th12-egoista", "gioele13", "accountsdump", "stephavellaneda", "ishare", "kixon1993", "proto26", "vonefas", "dracosilver", "superbad", "pelayo", "vasigo", "daraly", "level1sm", "maheshbhai", "jferdous", "chocolegend01", "ducthanh", "rus41-bot", "nessos", "dismayedworld", "manmen", "zavala", "bulletmind", "jurajimmy", "sm-school", "alobiun", "drsun", "shepz1", "aaronli", "gigel4", "papeda-pizza", "ninjamike", "dwinf", "shvara", "jiheref", "boobie-trap", "dinklebot", "mcoinz79", "xplosive", "azw", "chocoluche", "rodchenko", "doom2", "ran.koree", "paredao", "quatre-raberba", "dredgenyor", "lime-soup", "jamzmie", "ksantoprotein", "mikan-milkshake", "pesterson", "thomasward9", "butanopropan", "jomeb", "untamedspirit", "transom", "khaled1997", "squatme", "labold", "feduk", "rus46-bot", "po2", "oryans.belt", "yitige", "seblak", "bimol", "idkpdx", "logika", "mctoph", "whizzkid", "clausewitz", "enminers-13", "cesarmorles", "zu-jyuva", "cryptosales", "rus29-bot", "hafizz", "megateo", "urgrant", "febil", "torachibi", "if-time", "cryplectibles", "francis228", "hanen", "thegamechain", "erikkartmen", "tezcatli", "danny23", "dflz17", "siong", "cryptissues", "chrstnv", "creationlogic", "bengiles", "belaz", "tepobib", "figaro001", "retirebygaming", "smoner", "itisfinished", "malric-inferno", "silverwinner", "howerot", "waterchasers", "rikyu", "tomy5", "ana-maria", "beco132", "orangelo-oatmeal", "soang", "bereg", "elukas", "atnep111", "civilengineer13", "wisdome", "rus15-bot", "tronhill", "tr77", "tyreen", "mi2", "khazbot", "scar1ett", "monsterfightclub", "divachev", "rearguard", "karlosjmp", "athira", "lucassgrfy", "andrenavarro", "coolepicguy123", "caritoos", "bobor", "lzh1703", "pauleniuks", "splinterland", "inventive-isle", "seens", "electru", "agridulce2", "cryp71x", "armenian-gull", "ronyparra", "chocolinda", "asadnaymur", "galdirea", "rus03-bot", "orange-pie", "anneadam", "derion", "w121212", "brumgunter", "habibabiba", "stolik", "hitono", "tyara", "stranniksenya", "clap-trap", "proteus", "therentaltest", "hausner", "mawichan04", "bronkong", "sebaf", "guerrillakills", "pokat", "burdjg", "krabik", "naythan", "iceweex", "chicoduro", "alex-alexander", "antithb", "winmaster1", "banktest", "verlaat", "chargeblock", "s77assistant", "greens-creek", "eyewitness", "xandr", "reversemagnetar", "lolq", "amelino", "nirat", "sxsy", "tibl", "parnter", "andrea01", "stairway2heaven", "rus49-bot", "emilius", "loperdt", "biplan", "lice", "softa", "genesis05", "trezeke", "sc-steemit", "bbdragon", "mad-moxxi", "makspowerbro7", "thevilspawn", "swarmee", "thevil", "chipman", "zhivchak003", "sanze", "brunay", "toffie", "rus38-bot", "pomelo-pancake", "greatbulloffire", "ryanrother", "koosventerza", "nelpa411", "boroznak", "limurg", "vvonderlander", "esteh", "lalong", "jwjqu.wam", "ywe", "chromiumone", "bakpao", "didara", "periods", "rus37-bot", "zoje", "alangrizz", "torbaap", "damaskinus", "pionerbank", "gamegiveaways", "sm-rules", "dmitriyyandreev", "enminers-6", "kelse", "rus33-bot", "azt", "thedragonwarrior", "adversus", "soulseeker-bcn", "cal2", "tortila", "splinterquest", "didara", "lolq", "realrj", "azt", "thedragonwarrior", "adversus", "soulseeker-bcn", "lapierre", "cal2", "galdirea", "hirume", "khalifaimaman", "stevescoins", "sm-skynet", "flyingkrak", "raste", "yousafharoonkhan", "adelinak", "soldieroffire", "normanrainbows", "gpiglioni", "rus30-bot", "szymonkus", "ywe", "clicktokill", "nivanger", "alextribeck100", "sketcher", "invest2learn", "bala-sm", "sagesigma", "therentaltest", "tagal", "makspowerbro10", "devo4ka", "rosew", "enminers-6", "kolxoz", "mortysanchez", "xum", "marinmex", "rus27-bot", "sxsy", "kristhall", "wasseir", "citron-cider", "momih", "xta", "rus11-bot", "tamer34", "minismallholding", "meheraj", "gigel4", "dilar", "makspowerbro5", "ig-100", "posty", "supercuota", "bzybyte", "erwinj888", "buckfourton", "amanfoi", "maloveg", "cadbane", "reavercois", "azq", "siviv", "rus13-bot", "madasaboxof", "valapop", "wxw", "cassidyandfranks", "cal3", "yeaho", "bazilik", "cryptocrusaders", "fenyrahma", "alexgamer", "ivansnz", "pomelo-pancake", "kamillaevd", "eirik", "oscaryayoy8", "imila", "sensful", "jznsamuel", "falen", "traveljack894", "nyswine", "wamele", "duun", "anttila", "rus43-bot", "aicu", "dobroman", "monstress", "notzna", "cryptomb", "makspowerbro13", "calwa", "jodzuone",'tungnguyenf8',' DMALINA',' bronzechicken2',' tiendung004',' tiendzung015',' velandan',' hyiponlinef',' tiendzung012',' rkps',' dgu-dgul',' quycmf8',' romapopov1190',' parladar',' watchpaper8320',' unan1',' lyannainferno2',' hamsterperson',' nicole-st',' nongru6',' proizvedenie',' korshack',' laskal',' cloudskyuiu',' ABUZER357',' myso',' cryptomonkeys-cc',' miningbees03',' peterlane',' malchick',' pauljencio',' ngoclinhmuoif6',' tiendzung019',' uyenniel',' blago1',' NELOANGELO',' august6314',' fedil',' locnguyenciu',' eclipsus',' thaihang12',' bola8',' camerayoosee202',' larinett',' titannichyip',' luubadaif7',' buteco',' tiendzung010',' fakemilka3',' DiegoTrinh',' lamtuanvu',' benderreborn',' ngoclinhf90',' okthen',' chryonex31',' linhnv010',' y327322408',' cameraxmeye104',' zazza77',' y325824613',' kaineki',' kimidoram8',' hidrante',' angelino114',' linhnv011',' trinhnguyenf98',' angela77',' dangthai123',' camerayoosee204',' nongru5',' fakemilka4',' buysomething1',' tiendzung014',' bynarang',' y376294831',' felix199810',' homa322',' hckfy197',' erwin.alcober',' ngochienmuoif1',' cryptomusk',' chanchanfi',' hantinf66',' yeuemffu',' banza',' monsterheaven',' lucidialcake',' monterarni',' irina456vl',' preta',' quantumexplorers',' mindingo',' MEDALOGON',' restongungui',' plavki',' cameraxmeye105',' jerry.van.lee',' karavan110803',' gribok',' jgkforork',' tiendzung011',' sixsamurai-fuuma']
const battles = usersToGrab.map(user =>
    getBattleHistory(user)
    .then(battles => battles.map(
        battle => {
            const details = JSON.parse(battle.details);
            if (details.type != 'Surrender') {
                if (battle.winner && battle.winner == battle.player_1) {
                    const monstersDetails = extractMonster(details.team1)
                    const info = extractGeneralInfo(battle)
                    return {
                        ...monstersDetails,
                        ...info,
                        battle_queue_id: battle.battle_queue_id_1,
                        player_rating_initial: battle.player_1_rating_initial,
                        player_rating_final: battle.player_1_rating_final,
                        winner: battle.player_1,

                    }
                } else if (battle.winner && battle.winner == battle.player_2) {
                    const monstersDetails = extractMonster(details.team2)
                    const info = extractGeneralInfo(battle)
                    return {
                        ...monstersDetails,
                        ...info,
                        battle_queue_id: battle.battle_queue_id_2,
                        player_rating_initial: battle.player_2_rating_initial,
                        player_rating_final: battle.player_2_rating_final,
                        winner: battle.player_2,
                    }
                }
            }

        })).then(x => battlesList = [...battlesList, ...x])
)

Promise.all(battles).then(() => {
    const cleanBattleList = battlesList.filter(x => x != undefined)
    fs.writeFile(`data/history.json`, JSON.stringify(cleanBattleList), function (err) {
        if (err) {
            console.log(err);
        }
    });
});